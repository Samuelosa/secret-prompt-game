<!DOCTYPE html>
<html>
<head>
  <title>💑 Secret Prompt Game</title>
  <style>
    body {
      background-color: #ffe6e6;
      font-family: Georgia, serif;
      color: #333;
      text-align: center;
      padding: 20px;
    }
    input, textarea, button {
      margin: 10px;
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #ccc;
      width: 80%;
      max-width: 400px;
    }
    button {
      background-color: #ff9999;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #ff6666;
    }
    #heart {
      font-size: 50px;
      color: red;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    #heart.show {
      opacity: 1;
      animation: floatUp 1s ease forwards;
    }
    @keyframes floatUp {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-50px); opacity: 0; }
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>
  <h1>💘 Secret Prompt Game 💘</h1>
  <div id="app"></div>
  <div id="heart">❤️</div>
  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "your-app.firebaseapp.com",
      projectId: "your-project-id",
      storageBucket: "your-app.appspot.com",
      messagingSenderId: "your-msg-id",
      appId: "your-app-id"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let gameId = prompt("Enter game ID to join 🦕");
    let name = prompt("Enter your name 💑");
    let isAnswerer = confirm("Are you the answerer? Click OK for Yes 💌, Cancel for No 💭");

    const ref = db.collection("games").doc(gameId);

    const appDiv = document.getElementById("app");
    const heart = document.getElementById("heart");

    function showHeart() {
      heart.classList.add("show");
      setTimeout(() => heart.classList.remove("show"), 1000);
    }

    if (isAnswerer) {
      ref.get().then(doc => {
        const data = doc.exists ? doc.data() : {};
        const prompts = [
          "What's your favorite memory with me? 😍",
          "What do you love most about us? 💖",
          "If you could take me anywhere, where would we go? ✈️",
          "What song reminds you of our love? 🎶",
          "Describe me in 3 words 💬",
          "What's something you want us to do together? 💑"
        ];
        const prompt = prompts[Math.floor(Math.random() * prompts.length)];
        appDiv.innerHTML = `
          <p><strong>Your prompt 💌:</strong><br>${prompt}</p>
          <textarea id="answer" placeholder="Type your heartfelt answer here 🦕..."></textarea><br>
          <button onclick="submitAnswer('${prompt}')">Send Answer 💘</button>
        `;
      });
    } else {
      ref.onSnapshot(doc => {
        const data = doc.data();
        if (!data || !data.answer) return;
        appDiv.innerHTML = `
          <p><strong>Answer received 💭:</strong><br>${data.answer}</p>
          <input id="guess" placeholder="What do you think the prompt was? 💌"><br>
          <button onclick="submitGuess()">Reveal 💘</button>
        `;
      });
    }

    function submitAnswer(promptText) {
      const answer = document.getElementById("answer").value;
      ref.set({ answer, prompt: promptText, guess: "", score: 0 });
      alert("Answer submitted! Ask your love to check now 🦕");
    }

    function submitGuess() {
      const guess = document.getElementById("guess").value;
      ref.get().then(doc => {
        const data = doc.data();
        const correct = confirm(`Real Prompt 💘: "${data.prompt}"
Your Guess 💭: "${guess}"

Was the guess close enough to count as correct? 💑`);
        let newScore = data.score;
        if (correct) {
          newScore++;
          showHeart();
        }
        ref.set({ answer: "", prompt: "", guess: guess, score: newScore });
        appDiv.innerHTML = `<p>Score: ${newScore} 💞</p><p>Get ready for the next round! 🥰</p>`;
      });
    }
  </script>
</body>
</html>
